<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
               xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
               xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
               xmlns:ingredientModel="clr-namespace:CookRecipesApp.Model.Ingredient"
               xmlns:viewmodel="clr-namespace:CookRecipesApp.ViewModel.Popups"
               x:Class="CookRecipesApp.View.Popups.AddIngredientPopup"
               x:DataType="viewmodel:AddIngredientPopupViewModel"
               BackgroundColor="#1f1f1f"            
               >

    
    <VerticalStackLayout Spacing="10">
        <Label Text="Add Ingredient"
               FontSize="20"
               FontAttributes="Bold"
               TextColor="White" 
               HorizontalOptions="Center"/>

        <Border
            StrokeShape="RoundRectangle, 35"
            Stroke="Transparent"
            BackgroundColor="#212121">
            <SearchBar
            TextColor="{StaticResource Porcelain}" Text="{Binding SearchText}"/>
        </Border>
        <CollectionView
            ItemsSource="{Binding FilteredIngredients}"
            SelectedItem="{Binding SelectedIngredient}"
            SelectionMode="Single"
            HeightRequest="100">
            <CollectionView.ItemTemplate>
                <DataTemplate x:DataType="ingredientModel:Ingredient">
                    <Border
                        Grid.Column="0"
                        StrokeShape="RoundRectangle, 20"
                        BackgroundColor="#212121"
                        Margin="8, 3"
                        Stroke="{StaticResource Evergreen}">
                        <VerticalStackLayout>
                            <Label Text="{Binding Name}" TextColor="{StaticResource Porcelain}" Margin="5" FontSize="17"/>
                        </VerticalStackLayout>
                    </Border>

                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Grid ColumnDefinitions="100, *" ColumnSpacing="10">

            <Border
                Grid.Column="0"
                StrokeShape="RoundRectangle, 20"
                Stroke="Transparent"
                BackgroundColor="#212121">
                <Entry Placeholder="Quantity" 
                       Keyboard="Numeric" 
                       Text="{Binding Quantity}" 
                       TextColor="White"
                       Margin="7, 0, 0, 0"
                       PlaceholderColor="Gray"/>
            </Border>

            <Border
                Grid.Column="1"
                StrokeShape="RoundRectangle, 20"
                Stroke="Transparent"
                BackgroundColor="#212121">
                <Picker 
                    Grid.Column="1" 
                    Title="Unit"
                    ItemsSource="{Binding SelectedIngredient.PossibleUnits}"
                    ItemDisplayBinding="{Binding Name}"
                    SelectedItem="{Binding SelectedUnit}"
                    TextColor="{StaticResource Porcelain}"
                    TitleColor="Gray"
                    Margin="7, 0, 7, 0"/>
            </Border>
        </Grid>

        <Button Text="Add" Command="{Binding ConfirmCommand}" 
                    BackgroundColor="{StaticResource PineTeal}" CornerRadius="10"/>

        <Button Text="Cancel" Command="{Binding CancelCommand}"
                    BackgroundColor="Transparent" TextColor="Gray"/>
    </VerticalStackLayout>

</toolkit:Popup>
